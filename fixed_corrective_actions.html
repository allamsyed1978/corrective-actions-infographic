
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Corrective Actions - Data Driven Decisions</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
  <style>
    body { font-family: Arial, sans-serif; margin: 2rem; background: #f8f9fa; }
    h2 { margin-top: 2rem; color: #333; }
    .chart-container { width: 100%; max-width: 600px; margin: 1rem auto; }
    table { border-collapse: collapse; width: 100%; background: white; }
    th, td { border: 1px solid #ccc; padding: 0.5rem; }
    th { background: #eee; }
    button { margin: 1rem auto; display: block; padding: 0.5rem 1rem; }
  </style>
</head>
<body>

<h2>Data Input Sheet for Corrective Actions</h2>
<p>Use this table to track corrective actions, root causes, and progress metrics. You can export this to Excel.</p>
<button onclick="exportTableToExcel()">Export to Excel</button>
<table id="caDataTable">
  <thead>
    <tr>
      <th>ID</th><th>Issue Description</th><th>Root Cause</th><th>CA Action Taken</th><th>Category</th>
      <th>Status</th><th>Owner</th><th>Due Date</th><th>Completion %</th><th>Impact Area</th>
    </tr>
  </thead>
  <tbody>
    <tr><td>CA-001</td><td>Late Monthly Report</td><td>Manual data entry</td><td>Automate reporting process</td><td>Process</td><td>In Progress</td><td>J. Smith</td><td>2025-08-01</td><td>60%</td><td>Efficiency</td></tr>
    <tr><td>CA-002</td><td>Customer Complaints</td><td>Miscommunication in support</td><td>Retrain support staff</td><td>People</td><td>Completed</td><td>A. Kumar</td><td>2025-07-10</td><td>100%</td><td>Customer Experience</td></tr>
    <tr><td>CA-003</td><td>System Downtime</td><td>Lack of failover mechanism</td><td>Deploy HA architecture</td><td>Technology</td><td>Planned</td><td>M. Chen</td><td>2025-09-15</td><td>0%</td><td>Continuity</td></tr>
  </tbody>
</table>

<h2>Sample Bar Chart</h2>
<div class="chart-container">
  <canvas id="sampleChart"></canvas>
  <button onclick="downloadChart('sampleChart', 'sample_chart')">Download PNG</button>
</div>

<script>
function exportTableToExcel() {
  const wb = XLSX.utils.book_new();
  const ws = XLSX.utils.table_to_sheet(document.getElementById("caDataTable"));
  XLSX.utils.book_append_sheet(wb, ws, "CorrectiveActions");
  XLSX.writeFile(wb, "Corrective_Actions_Data.xlsx");
}

function downloadChart(canvasId, filename) {
  const canvas = document.getElementById(canvasId);
  const a = document.createElement("a");
  a.href = canvas.toDataURL("image/png");
  a.download = filename + ".png";
  a.click();
}

// Sample chart
new Chart(document.getElementById("sampleChart"), {
  type: "bar",
  data: {
    labels: ["Process", "People", "Tech"],
    datasets: [{
      label: "Corrective Action Count",
      data: [5, 3, 2],
      backgroundColor: ["#007bff", "#6610f2", "#fd7e14"]
    }]
  },
  options: {
    responsive: true,
    plugins: {
      legend: { display: true }
    },
    scales: {
      y: { beginAtZero: true }
    }
  }
});
</script>
</body>
</html>
